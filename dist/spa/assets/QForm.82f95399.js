import{u as w,h as D,a as A,b as z,c as B,Q as K,v as L}from"./QBtn.b025d511.js";import{u as M,a as N}from"./use-dark.7699e1e3.js";import{r as _,f as c,h as g,g as O,s as F,t as k,p as G,i as H,j as J,k as U,n as W,l as X}from"./index.6001c1b9.js";import{u as Y,a as Z,b as ee}from"./ButtonComp.91b4f5eb.js";function te(t,b){const e=_(null),v=c(()=>t.disable===!0?null:g("span",{ref:e,class:"no-outline",tabindex:-1}));function s(u){const l=b.value;u!==void 0&&u.type.indexOf("key")===0?l!==null&&document.activeElement!==l&&l.contains(document.activeElement)===!0&&l.focus():e.value!==null&&(u===void 0||l!==null&&l.contains(u.target)===!0)&&e.value.focus()}return{refocusTargetEl:v,refocusTarget:s}}var oe={xs:30,sm:35,md:40,lg:50,xl:60};const ne={...N,...z,...Y,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:t=>t==="tf"||t==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},ae=["update:modelValue"];function re(t,b){const{props:e,slots:v,emit:s,proxy:u}=O(),{$q:l}=u,C=M(e,l),y=_(null),{refocusTargetEl:S,refocusTarget:I}=te(e,y),x=w(e,oe),m=c(()=>e.val!==void 0&&Array.isArray(e.modelValue)),o=c(()=>{const n=k(e.val);return m.value===!0?e.modelValue.findIndex(h=>k(h)===n):-1}),r=c(()=>m.value===!0?o.value!==-1:k(e.modelValue)===k(e.trueValue)),f=c(()=>m.value===!0?o.value===-1:k(e.modelValue)===k(e.falseValue)),V=c(()=>r.value===!1&&f.value===!1),q=c(()=>e.disable===!0?-1:e.tabindex||0),$=c(()=>`q-${t} cursor-pointer no-outline row inline no-wrap items-center`+(e.disable===!0?" disabled":"")+(C.value===!0?` q-${t}--dark`:"")+(e.dense===!0?` q-${t}--dense`:"")+(e.leftLabel===!0?" reverse":"")),a=c(()=>{const n=r.value===!0?"truthy":f.value===!0?"falsy":"indet",h=e.color!==void 0&&(e.keepColor===!0||(t==="toggle"?r.value===!0:f.value!==!0))?` text-${e.color}`:"";return`q-${t}__inner relative-position non-selectable q-${t}__inner--${n}${h}`}),i=c(()=>{const n={type:"checkbox"};return e.name!==void 0&&Object.assign(n,{".checked":r.value,"^checked":r.value===!0?"checked":void 0,name:e.name,value:m.value===!0?e.val:e.trueValue}),n}),d=Z(i),E=c(()=>{const n={tabindex:q.value,role:t==="toggle"?"switch":"checkbox","aria-label":e.label,"aria-checked":V.value===!0?"mixed":r.value===!0?"true":"false"};return e.disable===!0&&(n["aria-disabled"]="true"),n});function p(n){n!==void 0&&(F(n),I(n)),e.disable!==!0&&s("update:modelValue",R(),n)}function R(){if(m.value===!0){if(r.value===!0){const n=e.modelValue.slice();return n.splice(o.value,1),n}return e.modelValue.concat([e.val])}if(r.value===!0){if(e.toggleOrder!=="ft"||e.toggleIndeterminate===!1)return e.falseValue}else if(f.value===!0){if(e.toggleOrder==="ft"||e.toggleIndeterminate===!1)return e.trueValue}else return e.toggleOrder!=="ft"?e.trueValue:e.falseValue;return e.indeterminateValue}function T(n){(n.keyCode===13||n.keyCode===32)&&F(n)}function j(n){(n.keyCode===13||n.keyCode===32)&&p(n)}const Q=b(r,V);return Object.assign(u,{toggle:p}),()=>{const n=Q();e.disable!==!0&&d(n,"unshift",` q-${t}__native absolute q-ma-none q-pa-none`);const h=[g("div",{class:a.value,style:x.value,"aria-hidden":"true"},n)];S.value!==null&&h.push(S.value);const P=e.label!==void 0?D(v.default,[e.label]):A(v.default);return P!==void 0&&h.push(g("div",{class:`q-${t}__label q-anchor--skip`},P)),g("div",{ref:y,class:$.value,...E.value,onClick:p,onKeydown:T,onKeyup:j},h)}}var ce=B({name:"QToggle",props:{...ne,icon:String,iconColor:String},emits:ae,setup(t){function b(e,v){const s=c(()=>(e.value===!0?t.checkedIcon:v.value===!0?t.indeterminateIcon:t.uncheckedIcon)||t.icon),u=c(()=>e.value===!0?t.iconColor:null);return()=>[g("div",{class:"q-toggle__track"}),g("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},s.value!==void 0?[g(K,{name:s.value,color:u.value})]:void 0)]}return re("toggle",b)}}),de=B({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(t,{slots:b,emit:e}){const v=O(),s=_(null);let u=0;const l=[];function C(o){const r=typeof o=="boolean"?o:t.noErrorFocus!==!0,f=++u,V=(a,i)=>{e("validation"+(a===!0?"Success":"Error"),i)},q=a=>{const i=a.validate();return typeof i.then=="function"?i.then(d=>({valid:d,comp:a}),d=>({valid:!1,comp:a,err:d})):Promise.resolve({valid:i,comp:a})};return(t.greedy===!0?Promise.all(l.map(q)).then(a=>a.filter(i=>i.valid!==!0)):l.reduce((a,i)=>a.then(()=>q(i).then(d=>{if(d.valid===!1)return Promise.reject(d)})),Promise.resolve()).catch(a=>[a])).then(a=>{if(a===void 0||a.length===0)return f===u&&V(!0),!0;if(f===u){const{comp:i,err:d}=a[0];if(d!==void 0&&console.error(d),V(!1,i),r===!0){const E=a.find(({comp:p})=>typeof p.focus=="function"&&L(p.$)===!1);E!==void 0&&E.comp.focus()}}return!1})}function y(){u++,l.forEach(o=>{typeof o.resetValidation=="function"&&o.resetValidation()})}function S(o){o!==void 0&&F(o);const r=u+1;C().then(f=>{r===u&&f===!0&&(t.onSubmit!==void 0?e("submit",o):o!==void 0&&o.target!==void 0&&typeof o.target.submit=="function"&&o.target.submit())})}function I(o){o!==void 0&&F(o),e("reset"),W(()=>{y(),t.autofocus===!0&&t.noResetFocus!==!0&&x()})}function x(){ee(()=>{if(s.value===null)return;const o=s.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||s.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||s.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(s.value.querySelectorAll("[tabindex]"),r=>r.tabIndex!==-1);o!=null&&o.focus({preventScroll:!0})})}G(X,{bindComponent(o){l.push(o)},unbindComponent(o){const r=l.indexOf(o);r!==-1&&l.splice(r,1)}});let m=!1;return H(()=>{m=!0}),J(()=>{m===!0&&t.autofocus===!0&&x()}),U(()=>{t.autofocus===!0&&x()}),Object.assign(v.proxy,{validate:C,resetValidation:y,submit:S,reset:I,focus:x,getValidationComponents:()=>l}),()=>g("form",{class:"q-form",ref:s,onSubmit:S,onReset:I},A(b.default))}});export{de as Q,ce as a};
